[2024-07-13 21:47:02,579][demucs.train][INFO] - For logs, checkpoints and samples check /home/dat/Dokumente/weigl-master/demucs/outputs/xps/81b48f2b
[2024-07-13 21:47:02,580][dora.distrib][INFO] - world_size is 1, skipping init.
[2024-07-13 21:47:04,857][demucs.train][INFO] - Drumamba(
  (encoder): ModuleList(
    (0): Sequential(
      (0): Conv1d(2, 64, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): Identity()
      (3): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
      (4): GLU(dim=1)
      (5): Identity()
    )
    (1): Sequential(
      (0): Conv1d(64, 128, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): Identity()
      (3): Conv1d(128, 256, kernel_size=(1,), stride=(1,))
      (4): GLU(dim=1)
      (5): Identity()
    )
    (2): Sequential(
      (0): Conv1d(128, 256, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): Identity()
      (3): Conv1d(256, 512, kernel_size=(1,), stride=(1,))
      (4): GLU(dim=1)
      (5): Identity()
    )
    (3): Sequential(
      (0): Conv1d(256, 512, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): Identity()
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=512, out_features=2048, bias=False)
              (conv1d): Conv1d(1024, 1024, kernel_size=(4,), stride=(1,), padding=(3,), groups=1024)
              (act): SiLU()
              (x_proj): Linear(in_features=1024, out_features=64, bias=False)
              (dt_proj): Linear(in_features=32, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=512, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=512, out_features=2048, bias=False)
              (conv1d): Conv1d(1024, 1024, kernel_size=(4,), stride=(1,), padding=(3,), groups=1024)
              (act): SiLU()
              (x_proj): Linear(in_features=1024, out_features=64, bias=False)
              (dt_proj): Linear(in_features=32, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=512, bias=False)
            )
            (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 512, eps=1e-05, affine=True)
          )
        )
      )
      (4): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
      (5): GLU(dim=1)
      (6): Identity()
    )
    (4): Sequential(
      (0): Conv1d(512, 1024, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): GroupNorm(4, 1024, eps=1e-05, affine=True)
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=1024, out_features=4096, bias=False)
              (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
              (act): SiLU()
              (x_proj): Linear(in_features=2048, out_features=96, bias=False)
              (dt_proj): Linear(in_features=64, out_features=2048, bias=True)
              (out_proj): Linear(in_features=2048, out_features=1024, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=1024, out_features=4096, bias=False)
              (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
              (act): SiLU()
              (x_proj): Linear(in_features=2048, out_features=96, bias=False)
              (dt_proj): Linear(in_features=64, out_features=2048, bias=True)
              (out_proj): Linear(in_features=2048, out_features=1024, bias=False)
            )
            (conv): Conv1d(2048, 2048, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 1024, eps=1e-05, affine=True)
          )
        )
      )
      (4): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,))
      (5): GLU(dim=1)
      (6): GroupNorm(4, 1024, eps=1e-05, affine=True)
    )
    (5): Sequential(
      (0): Conv1d(1024, 2048, kernel_size=(8,), stride=(4,))
      (1): GELU(approximate='none')
      (2): GroupNorm(4, 2048, eps=1e-05, affine=True)
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (conv1d): Conv1d(4096, 4096, kernel_size=(4,), stride=(1,), padding=(3,), groups=4096)
              (act): SiLU()
              (x_proj): Linear(in_features=4096, out_features=160, bias=False)
              (dt_proj): Linear(in_features=128, out_features=4096, bias=True)
              (out_proj): Linear(in_features=4096, out_features=2048, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (conv1d): Conv1d(4096, 4096, kernel_size=(4,), stride=(1,), padding=(3,), groups=4096)
              (act): SiLU()
              (x_proj): Linear(in_features=4096, out_features=160, bias=False)
              (dt_proj): Linear(in_features=128, out_features=4096, bias=True)
              (out_proj): Linear(in_features=4096, out_features=2048, bias=False)
            )
            (conv): Conv1d(4096, 4096, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 2048, eps=1e-05, affine=True)
          )
        )
      )
      (4): Conv1d(2048, 4096, kernel_size=(1,), stride=(1,))
      (5): GLU(dim=1)
      (6): GroupNorm(4, 2048, eps=1e-05, affine=True)
    )
  )
  (decoder): ModuleList(
    (0): Sequential(
      (0): Conv1d(2048, 4096, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): GroupNorm(4, 2048, eps=1e-05, affine=True)
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (conv1d): Conv1d(4096, 4096, kernel_size=(4,), stride=(1,), padding=(3,), groups=4096)
              (act): SiLU()
              (x_proj): Linear(in_features=4096, out_features=160, bias=False)
              (dt_proj): Linear(in_features=128, out_features=4096, bias=True)
              (out_proj): Linear(in_features=4096, out_features=2048, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (conv1d): Conv1d(4096, 4096, kernel_size=(4,), stride=(1,), padding=(3,), groups=4096)
              (act): SiLU()
              (x_proj): Linear(in_features=4096, out_features=160, bias=False)
              (dt_proj): Linear(in_features=128, out_features=4096, bias=True)
              (out_proj): Linear(in_features=4096, out_features=2048, bias=False)
            )
            (conv): Conv1d(4096, 4096, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 2048, eps=1e-05, affine=True)
          )
        )
      )
      (4): ConvTranspose1d(2048, 1024, kernel_size=(8,), stride=(4,))
      (5): GELU(approximate='none')
      (6): GroupNorm(4, 1024, eps=1e-05, affine=True)
    )
    (1): Sequential(
      (0): Conv1d(1024, 2048, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): GroupNorm(4, 1024, eps=1e-05, affine=True)
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=1024, out_features=4096, bias=False)
              (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
              (act): SiLU()
              (x_proj): Linear(in_features=2048, out_features=96, bias=False)
              (dt_proj): Linear(in_features=64, out_features=2048, bias=True)
              (out_proj): Linear(in_features=2048, out_features=1024, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=1024, out_features=4096, bias=False)
              (conv1d): Conv1d(2048, 2048, kernel_size=(4,), stride=(1,), padding=(3,), groups=2048)
              (act): SiLU()
              (x_proj): Linear(in_features=2048, out_features=96, bias=False)
              (dt_proj): Linear(in_features=64, out_features=2048, bias=True)
              (out_proj): Linear(in_features=2048, out_features=1024, bias=False)
            )
            (conv): Conv1d(2048, 2048, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 1024, eps=1e-05, affine=True)
          )
        )
      )
      (4): ConvTranspose1d(1024, 512, kernel_size=(8,), stride=(4,))
      (5): GELU(approximate='none')
      (6): GroupNorm(4, 512, eps=1e-05, affine=True)
    )
    (2): Sequential(
      (0): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): Identity()
      (3): ResMamba(
        (layers): ModuleList(
          (0): BiMambaWrapper(
            (mamba_forw): Mamba(
              (in_proj): Linear(in_features=512, out_features=2048, bias=False)
              (conv1d): Conv1d(1024, 1024, kernel_size=(4,), stride=(1,), padding=(3,), groups=1024)
              (act): SiLU()
              (x_proj): Linear(in_features=1024, out_features=64, bias=False)
              (dt_proj): Linear(in_features=32, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=512, bias=False)
            )
            (mamba_back): Mamba(
              (in_proj): Linear(in_features=512, out_features=2048, bias=False)
              (conv1d): Conv1d(1024, 1024, kernel_size=(4,), stride=(1,), padding=(3,), groups=1024)
              (act): SiLU()
              (x_proj): Linear(in_features=1024, out_features=64, bias=False)
              (dt_proj): Linear(in_features=32, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=512, bias=False)
            )
            (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
            (act): GLU(dim=1)
            (norm_fn): GroupNorm(1, 512, eps=1e-05, affine=True)
          )
        )
      )
      (4): ConvTranspose1d(512, 256, kernel_size=(8,), stride=(4,))
      (5): GELU(approximate='none')
      (6): Identity()
    )
    (3): Sequential(
      (0): Conv1d(256, 512, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): Identity()
      (3): ConvTranspose1d(256, 128, kernel_size=(8,), stride=(4,))
      (4): GELU(approximate='none')
      (5): Identity()
    )
    (4): Sequential(
      (0): Conv1d(128, 256, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): Identity()
      (3): ConvTranspose1d(128, 64, kernel_size=(8,), stride=(4,))
      (4): GELU(approximate='none')
      (5): Identity()
    )
    (5): Sequential(
      (0): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (1): GLU(dim=1)
      (2): Identity()
      (3): ConvTranspose1d(64, 8, kernel_size=(8,), stride=(4,))
    )
  )
  (skip_scales): ModuleList()
)
[2024-07-13 21:47:04,860][demucs.train][INFO] - Size: 1040.4 MB
[2024-07-13 21:47:04,861][demucs.train][INFO] - Field: 108.3 ms
